<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Simulating delayed time series · Tonari.jl</title><meta name="title" content="Simulating delayed time series · Tonari.jl"/><meta property="og:title" content="Simulating delayed time series · Tonari.jl"/><meta property="twitter:title" content="Simulating delayed time series · Tonari.jl"/><meta name="description" content="Tonari.jl:"/><meta property="og:description" content="Tonari.jl:"/><meta property="twitter:description" content="Tonari.jl:"/><script data-outdated-warner src="../assets/warner.js"></script><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.050/juliamono.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.8/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL=".."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../assets/documenter.js"></script><script src="../search_index.js"></script><script src="../siteinfo.js"></script><script src="../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/catppuccin-mocha.css" data-theme-name="catppuccin-mocha"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/catppuccin-macchiato.css" data-theme-name="catppuccin-macchiato"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/catppuccin-frappe.css" data-theme-name="catppuccin-frappe"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/catppuccin-latte.css" data-theme-name="catppuccin-latte"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../assets/themeswap.js"></script></head><body><div id="documenter"><nav class="docs-sidebar"><a class="docs-logo" href="../"><img src="../assets/logo.svg" alt="Tonari.jl logo"/></a><div class="docs-package-name"><span class="docs-autofit"><a href="../">Tonari.jl</a></span></div><button class="docs-search-query input is-rounded is-small is-clickable my-2 mx-auto py-1 px-2" id="documenter-search-query">Search docs (Ctrl + /)</button><ul class="docs-menu"><li><a class="tocitem" href="../">Home</a></li><li><span class="tocitem">Simulations</span><ul><li><a class="tocitem" href="../simulations/">Simulating univariate time series</a></li><li class="is-active"><a class="tocitem" href>Simulating delayed time series</a><ul class="internal"><li><a class="tocitem" href="#With-a-constant-phaselag"><span>With a constant phaselag</span></a></li></ul></li></ul></li><li><span class="tocitem">Spectral analysis</span><ul><li><a class="tocitem" href="../periodogram/">Periodogram computation</a></li></ul></li><li><a class="tocitem" href="../references/">References</a></li><li><a class="tocitem" href="../api/">API Reference</a></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><a class="docs-sidebar-button docs-navbar-link fa-solid fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a><nav class="breadcrumb"><ul class="is-hidden-mobile"><li><a class="is-disabled">Simulations</a></li><li class="is-active"><a href>Simulating delayed time series</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>Simulating delayed time series</a></li></ul></nav><div class="docs-right"><a class="docs-navbar-link" href="https://github.com/mlefkir/Tonari.jl" title="View the repository on GitHub"><span class="docs-icon fa-brands"></span><span class="docs-label is-hidden-touch">GitHub</span></a><a class="docs-navbar-link" href="https://github.com/mlefkir/Tonari.jl/blob/main/docs/src/simulations_delays.md" title="Edit source on GitHub"><span class="docs-icon fa-solid"></span></a><a class="docs-settings-button docs-navbar-link fa-solid fa-gear" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-article-toggle-button fa-solid fa-chevron-up" id="documenter-article-toggle-button" href="javascript:;" title="Collapse all docstrings"></a></div></header><article class="content" id="documenter-page"><h1 id="Simulating-delayed-time-series"><a class="docs-heading-anchor" href="#Simulating-delayed-time-series">Simulating delayed time series</a><a id="Simulating-delayed-time-series-1"></a><a class="docs-heading-anchor-permalink" href="#Simulating-delayed-time-series" title="Permalink"></a></h1><p>Let&#39;s simulate two time series with a delay </p><pre><code class="language-julia hljs">using Tonari
using Random
using Plots
using StatsBase
rng = MersenneTwister(42)</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">Random.MersenneTwister(42)</code></pre><p>Let&#39;s define the individual power spectral densities and the delay</p><pre><code class="language-julia hljs">p1 = SingleBendingPowerLaw(1.0, 0.63, 10e-2, 3.22)
p2 = SingleBendingPowerLaw(1.0, 0.78, 13e-2, 3.81)
Δϕ = ConstantTimeLag(12.35)

cs = CrossSpectralDensity(p1, p2, Δϕ)</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">CrossSpectralDensity(SingleBendingPowerLaw{Float64}(1.0, 0.63, 0.1, 3.22), SingleBendingPowerLaw{Float64}(1.0, 0.78, 0.13, 3.81), ConstantTimeLag(12.35))</code></pre><pre><code class="language-julia hljs">T, Δt = 504.2, 0.133
simu = Simulation(cs, T, Δt)</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">Simulation{CrossSpectralDensity, Float64, Float64, Float64, Float64}(CrossSpectralDensity(SingleBendingPowerLaw{Float64}(1.0, 0.63, 0.1, 3.22), SingleBendingPowerLaw{Float64}(1.0, 0.78, 0.13, 3.81), ConstantTimeLag(12.35)), 504.2, 0.133, 10.0, 10.0, 0.0:0.133:504.07)</code></pre><pre><code class="language-julia hljs">t, y, yerr = sample(rng,simu,50,error_size=0.15)</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">([0.0, 0.133, 0.266, 0.399, 0.532, 0.665, 0.798, 0.931, 1.064, 1.197  …  502.74000000000007, 502.87300000000005, 503.00600000000003, 503.13900000000007, 503.27200000000005, 503.40500000000003, 503.53800000000007, 503.67100000000005, 503.80400000000003, 503.937], Any[[0.14540626012963792 -0.3372528587315018 … 0.7221428835687854 -0.6950878379060956; 0.17240444651130177 -0.2253881450459741 … 0.6057977572430604 -0.713362776305405; … ; -0.2432329730508973 0.6987588928020517 … -0.766129078685697 -0.007163551207612564; -0.5312987915837379 0.7725344070948545 … -0.644369942219011 0.011847308241285128], [0.4484144315843172 -0.21748486236708023 … 0.29171790676388565 0.4574065177163349; 0.6106594744275852 -0.2782284689148241 … 0.32081094803010846 0.39693285928075955; … ; -0.43407536244643646 0.02632857659261642 … 0.37400830728866885 -0.40350275096617466; -0.43344251177144005 0.10424524605252494 … 0.5241440738731982 -0.44414597465770017]], Any[[0.09316054565792194 0.12627947902371947 … 0.10732082507477606 0.012911035164458235; 0.05850418201612983 0.002311285431170032 … 0.016643521225634863 0.031578127715112564; … ; 0.07285017702479835 0.27328609382092034 … 0.04008799132133673 0.008617518600219315; 0.070760823729467 0.28997867668409955 … 0.016414863810031953 0.0059181222082085325], [0.0015644291552101405 0.09353325781426057 … 0.08540631851812629 0.13968755562217222; 0.1458069700650134 0.022598883496501583 … 0.04365507574874362 5.6689638183007923e-5; … ; 0.011403711722566214 0.02631509565482505 … 0.07161683385281774 0.020979730571138; 0.04990167442114816 0.07486665523462405 … 0.07925261172592264 0.07217817798683895]])</code></pre><pre><code class="language-julia hljs">scatter(t,y[1][:,1],yerr=yerr[1][:,1],label=&quot;1&quot;, framestyle=:box)
scatter!(t,y[2][:,1],yerr=yerr[2][:,1],label=&quot;2&quot;, framestyle=:box, xlabel=&quot;Time (days)&quot;, ylabel=&quot;Value&quot;)</code></pre><img src="3edeb9ce.svg" alt="Example block output"/><pre><code class="language-julia hljs">f, γ², γ²_corrected, Δφ, γ²_err, γ²_corrected_err, Δφ_err, Δτ, Δτ_err, P̄₁, P̄₂, N₁, N₂, n = cross_periodogram(t, y[1], y[2], yerr[1],yerr[2])</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">([0.0019838514492034835, 0.003967702898406967, 0.00595155434761045, 0.007935405796813934, 0.009919257246017417, 0.0119031086952209, 0.013886960144424384, 0.015870811593627868, 0.01785466304283135, 0.019838514492034835  …  3.74154383319777, 3.743527684646973, 3.745511536096177, 3.74749538754538, 3.7494792389945837, 3.7514630904437873, 3.7534469418929906, 3.755430793342194, 3.757414644791398, 3.759398496240601], [0.9865502417566755; 0.9784675733095001; … ; 0.005223743323651598; 0.09422045709034309;;], [0.9868208145714209; 0.9789385146672256; … ; -68.94149363348129; 9.998997782315158;;], [0.15231580131811787; 0.2843702290686676; … ; 0.07780282242914097; 3.141592653589793;;], [0.0026718008112857376; 0.00425986848911318; … ; 0.014379583968801096; 0.055606441934206406;;], [0.05239416248345898; 0.06670398670850482; … ; 28.249576872978743; 4.225244236740772;;], [0.0013541128967381648; 0.0021768061636957977; … ; 1.3763677766951623; 0.2950868826760641;;], [12.219570523042226; 11.406833823829022; … ; 0.003295538274771968; 0.133;;], [0.10863402151753498; 0.08731738992962179; … ; 0.058299590511549336; 0.012492566581180026;;], [188457.44823236906; 111491.59483421344; … ; 33.99601446650122; 34.61672909475297;;], [422563.073030968; 226611.09683830454; … ; 44.22203268187743; 53.57798909497455;;], 33.20371348622743, 43.81546366403898, [445731.1769184233; 248158.62036842539; … ; 30.06101475519625; 36.81800266259647;;])</code></pre><pre><code class="language-julia hljs">plot(f,P̄₁,label=&quot;P₁&quot;)
plot!(f,P̄₂,xscale=:log10,yscale=:log10,label=&quot;P₂&quot;,xlabel=&quot;Frequency (d^-1)&quot;,ylabel=&quot;Power&quot;)
hline!([N₁,N₂],linestyle=:dash,label=&quot;noise level&quot;, framestyle=:box)</code></pre><img src="ced10565.svg" alt="Example block output"/><pre><code class="language-julia hljs">l = @layout [a; b]
p1 = scatter(f, γ²_corrected, yerr=γ²_corrected_err, label=&quot;γ² corrected&quot;,marker=:square,ms=4,xscale=:log10,size=(800,400))
p1 = scatter!(f, γ², yerr=γ²_err, label=&quot;γ²&quot;, xscale=:log10,ylims=(0,1.1),ms=4,ylabel=&quot;Coherence&quot;,link=:x, framestyle=:box)
p2 = scatter(f, Δτ, yerr=Δτ_err, xscale=:log10, ylabel=&quot;Time delay (d)&quot;,xlabel=&quot;Frequency (d^-1)&quot;,link=:x, framestyle=:box,label=nothing)
p2 = hline!([Δϕ.Δt],color=:black,label=&quot;True delay&quot;)
plot(p1, p2, layout=l,size=(800,600))</code></pre><img src="9faf7f94.svg" alt="Example block output"/><h2 id="With-a-constant-phaselag"><a class="docs-heading-anchor" href="#With-a-constant-phaselag">With a constant phaselag</a><a id="With-a-constant-phaselag-1"></a><a class="docs-heading-anchor-permalink" href="#With-a-constant-phaselag" title="Permalink"></a></h2><pre><code class="language-julia hljs">p1 = SingleBendingPowerLaw(1.0, 0.63, 10e-2, 3.22)
p2 = SingleBendingPowerLaw(1.0, 0.78, 13e-2, 3.81)
Δϕ = ConstantPhaseLag(12.35,5*1/T)

cs = CrossSpectralDensity(p1, p2, Δϕ)</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">CrossSpectralDensity(SingleBendingPowerLaw{Float64}(1.0, 0.63, 0.1, 3.22), SingleBendingPowerLaw{Float64}(1.0, 0.78, 0.13, 3.81), ConstantPhaseLag(12.35, 0.009916699722332408))</code></pre><pre><code class="language-julia hljs">T, Δt = 504.2, 0.133
simu = Simulation(cs, T, Δt)</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">Simulation{CrossSpectralDensity, Float64, Float64, Float64, Float64}(CrossSpectralDensity(SingleBendingPowerLaw{Float64}(1.0, 0.63, 0.1, 3.22), SingleBendingPowerLaw{Float64}(1.0, 0.78, 0.13, 3.81), ConstantPhaseLag(12.35, 0.009916699722332408)), 504.2, 0.133, 10.0, 10.0, 0.0:0.133:504.07)</code></pre><pre><code class="language-julia hljs">t, y, yerr = sample(rng,simu,50,error_size=0.15)</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">([0.0, 0.133, 0.266, 0.399, 0.532, 0.665, 0.798, 0.931, 1.064, 1.197  …  502.74000000000007, 502.87300000000005, 503.00600000000003, 503.13900000000007, 503.27200000000005, 503.40500000000003, 503.53800000000007, 503.67100000000005, 503.80400000000003, 503.937], Any[[-0.5804658687204048 0.022758312903943416 … 1.2839039752936134 0.22845120246956735; -0.46688135102715006 0.0026587801442473358 … 1.554020802491821 0.24947446346859745; … ; 0.0038998632751343913 0.14845298172673982 … 0.44408134071899613 1.1937269321107755; -0.02666238639640358 0.16368970457908374 … 0.5277964835510578 1.2583235571194002], [-0.15264746662977954 0.4019192214313062 … -0.6146913648182928 0.614002481212922; -0.16555377540309532 0.48777545349295276 … -0.6314758569495648 0.6881020653376854; … ; 0.44774770191086155 -0.9469994844505184 … 0.4253759906216337 -0.21111087481714996; 0.35233112210183437 -1.22860255165879 … 0.5729861501731172 -0.183197190972043]], Any[[0.04768836169839441 0.03407506263054265 … 0.1359798286653093 0.11124878073649916; 0.08302885283546194 0.030343631809900976 … 0.05434526854813363 0.005726996708012284; … ; 0.011587287951243109 0.007186918383638042 … 0.03145385276853477 0.01748939996822791; 0.012336358713198537 0.006054477664042381 … 0.1402039770314428 0.038986215553222285], [0.004362181240832013 0.12409916076161441 … 0.08096869930644153 0.08982294738619778; 0.022207762227684325 0.14416699504156924 … 0.054896937457977885 0.03641996719775653; … ; 0.051234538409160965 0.1660176009364129 … 0.06633308051869155 0.028767119681735346; 0.14898110470044715 0.24103524933298173 … 0.18585710219293328 0.0006821001343677552]])</code></pre><pre><code class="language-julia hljs">scatter(t,y[1][:,1],yerr=yerr[1][:,1],label=&quot;1&quot;, framestyle=:box)
scatter!(t,y[2][:,1],yerr=yerr[2][:,1],label=&quot;2&quot;, framestyle=:box, xlabel=&quot;Time (days)&quot;, ylabel=&quot;Value&quot;)</code></pre><img src="1f8ab44b.svg" alt="Example block output"/><pre><code class="language-julia hljs">f, γ², γ²_corrected, Δφ, γ²_err, γ²_corrected_err, Δφ_err, Δτ, Δτ_err, P̄₁, P̄₂, N₁, N₂, n = cross_periodogram(t, y[1], y[2], yerr[1],yerr[2])</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">([0.0019838514492034835, 0.003967702898406967, 0.00595155434761045, 0.007935405796813934, 0.009919257246017417, 0.0119031086952209, 0.013886960144424384, 0.015870811593627868, 0.01785466304283135, 0.019838514492034835  …  3.74154383319777, 3.743527684646973, 3.745511536096177, 3.74749538754538, 3.7494792389945837, 3.7514630904437873, 3.7534469418929906, 3.755430793342194, 3.757414644791398, 3.759398496240601], [0.746183482448313; 0.8901987772374766; … ; 0.0021256094160274227; 0.005403422469575061;;], [0.7464551938169051; 0.8905692477613282; … ; -1.6566489339226549; -0.9457141698915669;;], [-1.4755907239778752; -1.4278903910798102; … ; -2.252220667482584; 0.0;;], [0.04385031247131663; 0.020719566696850683; … ; 0.009201266411118828; 0.014622156180800532;;], [0.28063427991121365; 0.1616975196916589; … ; 45.18987289318353; 22.51303441555066;;], [0.02938306294816307; 0.011637606805723214; … ; 2.16438315095423; 1.3530458022793146;;], [-118.37960841065933; -57.27641906479808; … ; -0.09539858813838248; 0.0;;], [2.3572630467155546; 0.46681485391317573; … ; 0.09167800463456752; 0.05728148475822293;;], [136048.4003827304; 126494.88598738267; … ; 35.69233405592835; 38.14787477646318;;], [315943.6923459781; 253304.70340738344; … ; 48.51924924572563; 47.65195989367202;;], 32.44493369706703, 42.83409445811762, [321537.8486737363; 272707.16905410966; … ; 34.26606557047657; 35.8068999233884;;])</code></pre><pre><code class="language-julia hljs">plot(f,P̄₁,label=&quot;P₁&quot;)
plot!(f,P̄₂,xscale=:log10,yscale=:log10,label=&quot;P₂&quot;,xlabel=&quot;Frequency (d^-1)&quot;,ylabel=&quot;Power&quot;)
hline!([N₁,N₂],linestyle=:dash,label=&quot;noise level&quot;, framestyle=:box)</code></pre><img src="1d8969b5.svg" alt="Example block output"/><pre><code class="language-julia hljs">l = @layout [a; b ; c]
p1 = scatter(f, γ²_corrected, yerr=γ²_corrected_err, label=&quot;γ² corrected&quot;,marker=:square,ms=4,xscale=:log10,size=(800,400))
p1 = scatter!(f, γ², yerr=γ²_err, label=&quot;γ²&quot;, xscale=:log10,ylims=(0,1.1),ms=4,ylabel=&quot;Coherence&quot;,link=:x, framestyle=:box)

p2 = scatter(f, Δφ, yerr=Δφ_err, xscale=:log10, ylabel=&quot;Time delay (d)&quot;,xlabel=&quot;Frequency (d^-1)&quot;,link=:x, framestyle=:box,label=nothing)
# p2 = hline!([12.35],color=:black,label=&quot;True delay&quot;)
p2 = plot!(f,calculate(Δϕ,f) .* 2 .*pi .* f )
println(calculate(Δϕ,f[1]) .* 2 .*pi .* f[1] )

p3 = scatter(f, Δτ, yerr=Δτ_err, xscale=:log10, ylabel=&quot;Time delay (d)&quot;,xlabel=&quot;Frequency (d^-1)&quot;,link=:x, framestyle=:box,label=nothing)
p3 = plot!(f,-calculate(Δϕ,f) )

# p3 = hline!([12.35],color=:black,label=&quot;True delay&quot;)

plot(p1, p2,p3, layout=l,size=(800,900))</code></pre><img src="c1c30809.svg" alt="Example block output"/></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="../simulations/">« Simulating univariate time series</a><a class="docs-footer-nextpage" href="../periodogram/">Periodogram computation »</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="auto">Automatic (OS)</option><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option><option value="catppuccin-latte">catppuccin-latte</option><option value="catppuccin-frappe">catppuccin-frappe</option><option value="catppuccin-macchiato">catppuccin-macchiato</option><option value="catppuccin-mocha">catppuccin-mocha</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 1.7.0 on <span class="colophon-date" title="Thursday 19 September 2024 23:26">Thursday 19 September 2024</span>. Using Julia version 1.10.5.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
